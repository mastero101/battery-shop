<header class="bg-primary text-white shadow-sm">
  <div class="container py-2">
    <div class="row align-items-center">
      <div class="col-md-3 mb-2 mb-md-0">
        <a routerLink="/" class="d-flex align-items-center text-white text-decoration-none">
          <div class="logo-container me-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="logo-icon">
              <rect x="2" y="7" width="16" height="12" rx="1" ry="1" fill="#ffffff"/>
              <line x1="6" y1="7" x2="6" y2="7.01" stroke="#0d6efd"/>
              <line x1="10" y1="7" x2="10" y2="7.01" stroke="#0d6efd"/>
              <line x1="22" y1="11" x2="22" y2="13" stroke="#dc3545"/>
              <line x1="22" y1="15" x2="22" y2="17" stroke="#198754"/>
              <path d="M6 10v4" stroke="#0d6efd" stroke-width="3"/>
            </svg>
          </div>
          <div>
            <h1 class="h4 mb-0 fw-bold">PowerCell</h1>
            <p class="small mb-0 text-white-50">Energía Inteligente</p>
          </div>
        </a>
      </div>
      
      <div class="col-md-6 mb-3 mb-md-0">
        <form (ngSubmit)="onSearch()" class="d-flex">
          <input 
            type="text" 
            class="form-control me-2" 
            placeholder="Buscar productos..." 
            [(ngModel)]="searchQuery"
            name="searchQuery">
          <button class="btn btn-light" type="submit">
            <i class="bi bi-search"></i>
          </button>
        </form>
      </div>
      
      <div class="col-md-3 d-flex justify-content-end align-items-center">
        <!-- User Menu -->
        <div class="dropdown" [class.show]="isMenuOpen">
          <button 
            class="btn btn-link text-white text-decoration-none dropdown-toggle d-flex align-items-center" 
            type="button" 
            (click)="toggleMenu()"
            aria-expanded="false"
            id="userDropdown"
          >
            <i class="bi bi-person-circle fs-4 me-1"></i>
            <span class="d-none d-md-inline">{{ user ? user.firstName : 'Mi Cuenta' }}</span>
          </button>
          
          <ul 
            class="dropdown-menu dropdown-menu-end" 
            [class.show]="isMenuOpen"
            aria-labelledby="userDropdown"
            (click)="$event.stopPropagation()"
          >
            <li *ngIf="!user">
              <a class="dropdown-item" routerLink="/login" (click)="closeMenu()">
                <i class="bi bi-box-arrow-in-right me-2"></i>Iniciar sesión
              </a>
            </li>
            <li *ngIf="!user">
              <a class="dropdown-item" routerLink="/register" (click)="closeMenu()">
                <i class="bi bi-person-plus me-2"></i>Registrarse
              </a>
            </li>
            
            <li *ngIf="user">
              <a class="dropdown-item" routerLink="/account" (click)="closeMenu()">
                <i class="bi bi-person me-2"></i>Mi perfil
              </a>
            </li>
            <li *ngIf="user">
              <a class="dropdown-item" routerLink="/account/orders" (click)="closeMenu()">
                <i class="bi bi-box-seam me-2"></i>Mis pedidos
              </a>
            </li>
            <li *ngIf="user">
              <a class="dropdown-item" routerLink="/account/favorites" (click)="closeMenu()">
                <i class="bi bi-heart me-2"></i>Favoritos
                <span class="badge bg-primary rounded-pill ms-1" *ngIf="getFavoriteCount() > 0">
                  {{ getFavoriteCount() }}
                </span>
              </a>
            </li>
            <li *ngIf="user"><hr class="dropdown-divider"></li>
            <li *ngIf="user">
              <a class="dropdown-item text-danger" href="#" (click)="$event.preventDefault(); logout()">
                <i class="bi bi-box-arrow-right me-2"></i>Cerrar sesión
              </a>
            </li>
          </ul>
        </div>
        
        <!-- Cart -->
        <div class="ms-3 position-relative">
          <a routerLink="/cart" class="text-white position-relative">
            <i class="bi bi-cart fs-4"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
              *ngIf="cartItemCount > 0"
              style="font-size: 0.6rem;">
              {{ cartItemCount }}
              <span class="visually-hidden">items in cart</span>
            </span>
          </a>
        </div>
      </div>
    </div>
  </div>
</header>